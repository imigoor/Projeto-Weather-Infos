(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9250:function(e,i,a){Promise.resolve().then(a.bind(a,333))},333:function(e,i,a){"use strict";a.r(i),a.d(i,{default:function(){return h}});var t=a(7437),s=a(2265),n=a(8472);a(9252);var r=a(4446),c=a(4041);function l(e){let{post:i,add:a,remove:s,check:n,toggleFavorites:r}=e,{main:l,name:o,weather:d,wind:m,sys:u}=i;return(0,t.jsxs)(c.E.div,{className:"weather-card",initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{type:"spring",bounce:.5,duration:.7,delayChildren:.5,staggerChildren:.5},children:[(0,t.jsxs)("h2",{children:[o," ",(0,t.jsx)("sup",{children:u.country})]}),(0,t.jsxs)("h1",{children:[Math.round(l.temp),(0,t.jsx)("sup",{children:"\xb0C"})]}),(0,t.jsx)("img",{src:"/img/".concat(d[0].icon,".svg"),alt:"",className:"weather-img"}),(0,t.jsxs)("div",{className:"weather-details",children:[(0,t.jsxs)("div",{className:"humidity",children:[(0,t.jsx)("i",{className:"bi bi-water"}),(0,t.jsxs)("div",{className:"text",children:[(0,t.jsx)("span",{children:l.humidity}),(0,t.jsx)("p",{children:"Humidade"})]})]}),(0,t.jsxs)("div",{className:"wind",children:[(0,t.jsx)("i",{className:"bi bi-wind"}),(0,t.jsxs)("div",{className:"text",children:[(0,t.jsx)("span",{children:m.speed}),(0,t.jsx)("p",{children:"Velocidade"})]})]}),(0,t.jsx)("button",{className:"btn-favorite",children:(0,t.jsx)("i",{className:n(o)?"bi bi-star-fill":"bi bi-star",onClick:r})})]})]})}var o=e=>{let{message:i,duration:a,onClose:n}=e;return(0,s.useEffect)(()=>{if(i){let e=setTimeout(()=>{n()},a||3e3);return()=>clearTimeout(e)}},[i,a,n]),(0,t.jsx)(r.M,{children:i&&(0,t.jsx)(c.E.div,{className:"notification-box",initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:50},transition:{duration:.5},children:(0,t.jsx)("p",{children:i})})})},d=e=>{let{favorites:i,removeFromFavorites:a,displayFavoriteCity:n,isVisible:r,toggleVisibility:l}=e;return((0,s.useEffect)(()=>{},[i]),r)?(0,t.jsxs)(c.E.div,{className:"favorites-box",initial:{opacity:0},animate:{opacity:1},transition:{type:"spring",bounce:.5,duration:.7},children:[(0,t.jsx)("button",{className:"btn-hide",onClick:l,children:(0,t.jsx)("i",{className:"bi bi-x-circle"})}),(0,t.jsx)("h2",{children:"Favoritos"}),(0,t.jsx)("div",{className:"favorites-list",children:(0,t.jsx)("ul",{children:i.map(e=>(0,t.jsxs)("li",{"data-city":e,children:[(0,t.jsx)("span",{onClick:()=>n(e),children:e}),(0,t.jsx)("i",{className:"bi bi-star-fill",onClick:()=>a(e)})]},e))})})]}):null},m=e=>{let{showModal:i,setShowModal:a,handleMail:n}=e,[r,l]=(0,s.useState)("");return i?(0,t.jsx)(c.E.div,{className:"modal-mail",initial:{opacity:0},animate:{opacity:1},transition:{type:"spring",bounce:.5,duration:.7,delayChildren:.5,staggerChildren:.5},children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsx)("h1",{children:"Digite seu e-mail"}),(0,t.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(r)},children:(0,t.jsxs)("div",{className:"input-box",children:[(0,t.jsx)("input",{type:"email",value:r,onChange:e=>l(e.target.value),required:!0}),(0,t.jsx)("button",{type:"submit",className:"btn-submit",children:(0,t.jsx)("i",{className:"bi bi-box-arrow-in-right"})})]})}),(0,t.jsx)("button",{onClick:()=>a(!1),className:"btn-hide",children:(0,t.jsx)("i",{className:"bi bi-x-circle"})})]})}):null};let u=(0,a(4593).eI)("https://ssdvbegizsfanbzbmjbu.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzZHZiZWdpenNmYW5iemJtamJ1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjc1NzYyMDUsImV4cCI6MjA0MzE1MjIwNX0.jglYIKpGvEG539jrix4ZRQMlbptzx_SxcGGQS7nbEvc"),x=n.Z.create({baseURL:"https://api.openweathermap.org/data/2.5/"});function h(){let[e,i]=s.useState([]),[a,n]=s.useState(""),[h,b]=s.useState(""),[j,p]=s.useState(!1),[f,v]=s.useState(!1),[y,N]=s.useState(!1),[g,C]=s.useState([]),[w,E]=s.useState(""),[I,S]=s.useState(!1);s.useEffect(()=>{async function e(){try{let e="weather?q=".concat(h,"&appid=").concat("8f8c6a4b319c79cc99231b7f6c114d37","&units=metric&lang=pt_br"),a=await x.get(e);404===a.data.cod?(_("Cidade n\xe3o encontrada"),p(!1)):(i(e=>[...e,a.data]),M(),p(!0))}catch(e){console.log("Erro ao fazer a requisi\xe7\xe3o:",e),_("Cidade n\xe3o encontrada"),p(!1)}}h&&e()},[h]);let _=e=>{v(e)},M=()=>{v("")},k=e=>!!/^[a-zA-Z\u00C0-\u00FF\s]+$/.test(e),F=async()=>{if(!w){S(!0);return}let{data:e,error:i}=await u.from("citiesFav").select("city_name").eq("email",w);if(i){console.log("Erro ao buscar favoritos:",i),_("Erro ao buscar favoritos.");return}C(e)},z=async e=>{if(!w){S(!0);return}let{data:i,error:a}=await u.from("user").select("email").eq("email",w);if(0===i.length){let{data:e,error:i}=await u.from("user").insert([{email:w}])}let{data:t,error:s}=await u.from("citiesFav").insert([{email:w,city_name:e.name}]);if(s){console.log("Erro ao adicionar favorito:",s),_("Erro ao adicionar favorito.");return}F()},J=async e=>{let{data:i,error:a}=await u.from("citiesFav").delete().eq("email",w).eq("city_name",e);if(a){console.log("Erro ao remover favorito:",a),_("Erro ao remover favorito.");return}F()},Z=e=>g.some(i=>i.city_name===e),q=()=>{if(!w){S(!0);return}N(!y),F()},D=i=>{if(g.some(e=>e.city_name===i))J(i);else{let a=e.find(e=>e.name===i);a&&z(a)}};return(0,t.jsxs)("section",{className:"container",children:[(0,t.jsx)("button",{className:"btn-favorites","data-city":"${city.name}",onClick:()=>q(!y),children:(0,t.jsx)("i",{className:"bi bi-star-fill"})}),(0,t.jsx)(m,{showModal:I,setShowModal:S,handleMail:e=>{E(e),S(!1),F()}}),(0,t.jsx)(d,{favorites:g.map(e=>e.city_name),removeFromFavorites:J,displayFavoriteCity:b,isVisible:y,toggleVisibility:()=>q(!y)}),(0,t.jsxs)("div",{className:"city-box",children:[(0,t.jsx)("h1",{children:"Digite o nome de uma cidade:"}),(0,t.jsxs)("div",{className:"input-box",children:[(0,t.jsx)("i",{className:"bi bi-geo-alt-fill btn-geo"}),(0,t.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!k(a)){_("Nome da cidade inv\xe1lida");return}if(""===a){_("Digite alguma cidade.");return}b(a),n("")},children:[(0,t.jsx)("input",{type:"text",className:"input-cidade",value:a,onChange:e=>n(e.target.value)}),(0,t.jsx)("button",{type:"submit",className:"btn-submit",children:(0,t.jsx)("i",{className:"bi bi-search"})})]}),(0,t.jsx)("p",{className:"submit-warning"})]})]}),(0,t.jsx)("div",{className:"weather-box",children:(0,t.jsx)(r.M,{children:e.map((e,i)=>(0,t.jsx)(c.E.div,{initial:{opacity:0,x:100,scale:.9},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:-100},transition:{duration:.5},children:(0,t.jsx)(l,{post:e,add:z,remove:J,check:Z,toggleFavorites:()=>D(e.name)})},i))})}),(0,t.jsx)(o,{message:f,duration:3e3,onClose:M})]})}}},function(e){e.O(0,[51,719,971,23,744],function(){return e(e.s=9250)}),_N_E=e.O()}]);